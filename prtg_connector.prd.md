#### Назначение
`prtg_connector.py` – модуль библиотеки custom_modules, обеспечивающий интеграцию с PRTG и автоматизированный импорт данных об управляемых устройствах для дальнейшей обработки (например, добавления их в NetBox).
<br>

#### Требования к функционалу
##### Основной функционал
- Получение списка устройств из PRTG через API.
- Использование для работы только тега устройства; пользователь сам определяет, какие теги "цеплять" к какой логике посредством конфигурации (маппинга).
- Обработка только тех устройств, у которых есть тег, указанный в `PRTG_IMPORT_TAG` конфига, за исключением устройств, у которых найден тег исключения `PRTG_EXCLUDE_TAG`
- Возврат списка устройств в формате словарей с одинаковой структурой свойств как при загрузке CSV:
    - `'act'`
    - `'ip_device'`
    - `'community'`
    - `'site_slug'`
    - `'role'`
    - `'vm'`
    - `'snmp'`
    - `'model_oid'`
- Для PRTG устройства: `act = 'all'` (явная совместимость с CSV-логикой).
- Модуль реализован с помощью dataclass для работы с конфигурацией устройств.
<br>

##### Авторизация
- Использование только `apitoken` для доступа к PRTG API.
- Чтение параметров авторизации из переменных окружения (`PRTG_URL`, `PRTG_API_TOKEN`). Для целей отладки допускается также использовать `.env`.
<br>

##### SSL
Для внутреннего сервера допускается отключение проверки SSL-сертификата (опция конфигурации `PRTG_VERIFY_SSL`; по умолчанию проверка отключена).
<br>

##### Маппинг тегов
- Строгий запрет на хардкодинг логики интерпретации тегов в коде модуля.
- Все правила маппинга тегов во свойства устройств выведены в файл `config.py` в виде структуры:  
    ```python
        PRTG_TAG_MAPPING = {
          'role': { 'switch': 'Switch', ... },
          'community': { 'private_snmp': 'private', ... },
          ...
        }
    ```
    - Для каждого свойства (community, role, vm, snmp, site_slug, ...) может быть сопоставлен набор возможных тегов и их значений.
- Значения по умолчанию для всех свойств, кроме `ip_device` (он всегда берется из PRTG), задаются в конфиге через `PRTG_DEVICE_DEFAULTS`.
<br>

##### Обработка структуры данных
- Обеспечить совместимость формата c выводом `csv.DictReader()` для удобства одновременного использования в вызывающих скриптах различных источников данных.
- Использовать `dataclass` DeviceConfig для внутреннего представления устройства.
<br>

#### Ограничения и допущения
- Теги устройства в PRTG уже включают теги всех родительских групп, необходимость обхода дерева групп отсутствует.
- Нет необходимости фильтровать устройства по активности до запроса — фильтровать только по наличию нужных тегов.
- Требуется совместимая работа с csv_reader и сохранение всех привычных способом работы для дебага.
<br>
